<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data transformation | Covid Impact</title>
  <meta name="description" content="Chapter 3 Data transformation | Covid Impact" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data transformation | Covid Impact" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data transformation | Covid Impact" />
  
  
  

<meta name="author" content="Run Zhang, Miranda Zhou, Mohan Duan, Neha Pusarla" />


<meta name="date" content="2020-12-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-sources.html"/>
<link rel="next" href="missing-values.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>



<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CovidImpact</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a><ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#covid-cases"><i class="fa fa-check"></i><b>2.1</b> Covid Cases</a><ul>
<li class="chapter" data-level="2.1.1" data-path="data-sources.html"><a href="data-sources.html#description-for-covid-cases"><i class="fa fa-check"></i><b>2.1.1</b> Description for Covid Cases</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-sources.html"><a href="data-sources.html#description-for-covid-cases-per-capita"><i class="fa fa-check"></i><b>2.1.2</b> Description for Covid Cases per Capita</a></li>
<li class="chapter" data-level="2.1.3" data-path="data-sources.html"><a href="data-sources.html#basic-information-about-dataset"><i class="fa fa-check"></i><b>2.1.3</b> Basic Information about Dataset:</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#country-policy-orders"><i class="fa fa-check"></i><b>2.2</b> Country Policy Orders</a><ul>
<li class="chapter" data-level="2.2.1" data-path="data-sources.html"><a href="data-sources.html#description"><i class="fa fa-check"></i><b>2.2.1</b> Description</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-sources.html"><a href="data-sources.html#basic-information-about-dataset-1"><i class="fa fa-check"></i><b>2.2.2</b> Basic Information about Dataset:</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-sources.html"><a href="data-sources.html#hospitalization-data"><i class="fa fa-check"></i><b>2.3</b> Hospitalization Data</a><ul>
<li class="chapter" data-level="2.3.1" data-path="data-sources.html"><a href="data-sources.html#description-1"><i class="fa fa-check"></i><b>2.3.1</b> Description</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-sources.html"><a href="data-sources.html#basic-information-on-this-dataset"><i class="fa fa-check"></i><b>2.3.2</b> Basic Information on this dataset:</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-sources.html"><a href="data-sources.html#restaurant-data"><i class="fa fa-check"></i><b>2.4</b> Restaurant data</a><ul>
<li class="chapter" data-level="2.4.1" data-path="data-sources.html"><a href="data-sources.html#description-2"><i class="fa fa-check"></i><b>2.4.1</b> Description</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-sources.html"><a href="data-sources.html#airlines-data"><i class="fa fa-check"></i><b>2.5</b> Airlines Data</a><ul>
<li class="chapter" data-level="2.5.1" data-path="data-sources.html"><a href="data-sources.html#description-3"><i class="fa fa-check"></i><b>2.5.1</b> Description</a></li>
<li class="chapter" data-level="2.5.2" data-path="data-sources.html"><a href="data-sources.html#basic-information-about-dataset-2"><i class="fa fa-check"></i><b>2.5.2</b> Basic Information about Dataset:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a><ul>
<li class="chapter" data-level="3.1" data-path="data-transformation.html"><a href="data-transformation.html#covid-cases-1"><i class="fa fa-check"></i><b>3.1</b> Covid Cases</a></li>
<li class="chapter" data-level="3.2" data-path="data-transformation.html"><a href="data-transformation.html#country-policy-orders-1"><i class="fa fa-check"></i><b>3.2</b> Country Policy Orders</a></li>
<li class="chapter" data-level="3.3" data-path="data-transformation.html"><a href="data-transformation.html#hospitalization-data-1"><i class="fa fa-check"></i><b>3.3</b> Hospitalization Data</a></li>
<li class="chapter" data-level="3.4" data-path="data-transformation.html"><a href="data-transformation.html#airlines-covid-data"><i class="fa fa-check"></i><b>3.4</b> Airlines Covid Data</a></li>
<li class="chapter" data-level="3.5" data-path="data-transformation.html"><a href="data-transformation.html#restaurant-data-1"><i class="fa fa-check"></i><b>3.5</b> Restaurant data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a><ul>
<li class="chapter" data-level="4.1" data-path="missing-values.html"><a href="missing-values.html#covid-cases-2"><i class="fa fa-check"></i><b>4.1</b> Covid Cases</a></li>
<li class="chapter" data-level="4.2" data-path="missing-values.html"><a href="missing-values.html#country-policy-orders-2"><i class="fa fa-check"></i><b>4.2</b> Country Policy Orders</a></li>
<li class="chapter" data-level="4.3" data-path="missing-values.html"><a href="missing-values.html#hospitalization"><i class="fa fa-check"></i><b>4.3</b> Hospitalization</a></li>
<li class="chapter" data-level="4.4" data-path="missing-values.html"><a href="missing-values.html#airlines-covid-data-1"><i class="fa fa-check"></i><b>4.4</b> Airlines Covid Data</a></li>
<li class="chapter" data-level="4.5" data-path="missing-values.html"><a href="missing-values.html#restaurant-data-2"><i class="fa fa-check"></i><b>4.5</b> Restaurant data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a><ul>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#covid-cases-3"><i class="fa fa-check"></i><b>5.1</b> Covid Cases</a><ul>
<li class="chapter" data-level="5.1.1" data-path="results.html"><a href="results.html#covid-cases-in-each-state"><i class="fa fa-check"></i><b>5.1.1</b> Covid Cases in Each State</a></li>
<li class="chapter" data-level="5.1.2" data-path="results.html"><a href="results.html#covid19-cases-in-time-series"><i class="fa fa-check"></i><b>5.1.2</b> Covid19 Cases in Time Series</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="results.html"><a href="results.html#county"><i class="fa fa-check"></i><b>5.2</b> County</a></li>
<li class="chapter" data-level="5.3" data-path="results.html"><a href="results.html#hospital"><i class="fa fa-check"></i><b>5.3</b> Hospital</a></li>
<li class="chapter" data-level="5.4" data-path="results.html"><a href="results.html#covid-impact-on-airlines"><i class="fa fa-check"></i><b>5.4</b> Covid Impact on Airlines</a></li>
<li class="chapter" data-level="5.5" data-path="results.html"><a href="results.html#covid-impact-on-restaurants"><i class="fa fa-check"></i><b>5.5</b> Covid Impact on Restaurants</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Covid Impact</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-transformation" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Data transformation</h1>
<p>The code of our data transformation is <a href="https://github.com/run-zhang/CovidImpact/blob/main/03-cleaning.Rmd">here</a>
.</p>
<div id="covid-cases-1" class="section level2">
<h2><span class="header-section-number">3.1</span> Covid Cases</h2>
<p>For our covid cases, we integraled covid cases data from New York Times and census data from U.S. Census Bureau. The summary of our data is beblow:</p>
<pre><code>##     state               date                fips           cases             deaths         state_abbr         state_code        jurisdiction_type     ppl2019        
##  Length:51          Length:51          Min.   : 1.00   Min.   :   4100   Min.   :   67.0   Length:51          Length:51          Length:51          Min.   :  578759  
##  Class :character   Class :character   1st Qu.:16.50   1st Qu.:  79282   1st Qu.:  925.5   Class :character   Class :character   Class :character   1st Qu.: 1789606  
##  Mode  :character   Mode  :character   Median :29.00   Median : 195545   Median : 3025.0   Mode  :character   Mode  :character   Mode  :character   Median : 4467673  
##                                        Mean   :28.96   Mean   : 261816   Mean   : 5206.4                                                            Mean   : 6436069  
##                                        3rd Qu.:41.50   3rd Qu.: 335985   3rd Qu.: 6042.0                                                            3rd Qu.: 7446805  
##                                        Max.   :56.00   Max.   :1247065   Max.   :34101.0                                                            Max.   :39512223  
##     case_ppl        case_ppl_log       case_log         hover          
##  Min.   :0.00700   Min.   :-5.025   Min.   : 8.319   Length:51         
##  1st Qu.:0.03300   1st Qu.:-3.424   1st Qu.:11.281   Class :character  
##  Median :0.04400   Median :-3.133   Median :12.184   Mode  :character  
##  Mean   :0.04373   Mean   :-3.239   Mean   :11.933                     
##  3rd Qu.:0.05250   3rd Qu.:-2.954   3rd Qu.:12.725                     
##  Max.   :0.10300   Max.   :-2.271   Max.   :14.036</code></pre>
</div>
<div id="country-policy-orders-1" class="section level2">
<h2><span class="header-section-number">3.2</span> Country Policy Orders</h2>
<p>This dataset comes in a csv format, which can be read in using “read.csv()”. As described earlier, each row in this dataset is either a start or end of a policy. There is also information on both county and states. For our analysis, we will look at county and states separately. In addition, when we aggregate the number of states that enacted certain policies, we will only look at values where “start_stop” is “start” so we do not count double. Using this information we will determine how covid policies in each state had a role in how much each state got affected by the virus.</p>
<p>County Policies:</p>
<pre><code>##   state_id  county fips_code policy_level       date      policy_type start_stop total_phases
## 2       TX  Kinney     48271       county 2020-07-03 Mask Requirement      start           NA
## 3       ID  Custer     16037       county 2020-10-27          Phase 3      start            4
## 4       UT   Wayne     49055       county 2020-11-24          Phase 1      start            3
## 5       TX  Borden     48033       county 2020-07-03 Mask Requirement      start           NA
## 7       IN    Lake     18089       county 2020-05-11          Phase 2      start            5
## 9       CA Ventura      6111       county 2020-11-16   Food and Drink      start           NA</code></pre>
<p>State:</p>
<pre><code>##    state_id county fips_code policy_level       date                                                         policy_type start_stop total_phases
## 1        HI               NA        state 2020-05-18                                                       Manufacturing      start           NA
## 6        IA               NA        state 2020-05-28                                                    Childcare (K-12)      start           NA
## 8        IN               NA        state 2020-05-04                                                             Phase 2      start            5
## 10       TN               NA        state 2020-03-25 Stop Initiation Of Evictions Overall Or Due To Covid Related Issues      start           NA
## 11       VT               NA        state 2020-03-20                                         Allow Audio Only Telehealth      start           NA
## 13       CT               NA        state 2020-03-19                                         Allow Audio Only Telehealth      start           NA</code></pre>
<p>Finally, we created this table by counting all the times each state appears in the previous dataframe to see how many policies each state enacted. This information is fed into our map visualization.</p>
<pre><code>##   state_id  n
## 1       AK 26
## 2       AL 23
## 3       AR 24
## 4       AZ 21
## 5       CA 21
## 6       CO 33</code></pre>
</div>
<div id="hospitalization-data-1" class="section level2">
<h2><span class="header-section-number">3.3</span> Hospitalization Data</h2>
<p>This dataset comes in a csv format, which can be read in using “read.csv()”. As seen in the dataset description, there are many different columns with a variety of different values. We are only concentrating on a few of these values in our analysis so we split the dataframe up. We will analyze inpatient bed use which is column index 40 to 51. We then calculate the proportion of beds used by covid patients, non-covid patients, and empty beds. To do this, we extract total bed “inpatient bed”, covid bed “inpatient_beds_used_covid”, non-covid bed “inpatient_beds_used - covid_bed”, and empty bed “total bed - inpatient_beds_used”. This information will be used to analyze how hospitalization has increased, and how much coronavirus has taken over hospital beds.</p>
<pre><code>##   state covid_bed not_covid_bed empty_bed
## 1    PR       687          3981      4072
## 2    RI       453          1489       261
## 3    SC       817          6720      2482
## 4    SD       541          1028      1042
## 5    TN      2499         10553      6736
## 6    TX      9455         39152     21132</code></pre>
<p>We also analyze staffing shortages in a similar fashion. Staff information is columns 1-7. We then calculate the proportion by diving those that reported “critical staffing shortage today yes” over the sum of both yes and no.</p>
<pre><code>##   hospital.state staff_short_prop
## 1             PR        0.3181818
## 2             RI        0.1538462
## 3             SC        0.3142857
## 4             SD        0.1694915
## 5             TN        0.2307692
## 6             TX        0.2264151</code></pre>
</div>
<div id="airlines-covid-data" class="section level2">
<h2><span class="header-section-number">3.4</span> Airlines Covid Data</h2>
<p>This dataset comes in a xlsx format, therefore we installed the “readxl” package, and read in the data using the commands from that package. Since there are some extra spaces in the excel sheet, we remade the table into a form that had no blank spaces, and thus easily callable by column name, which is a dataframe in R. Combining all the columns together into a dataframe, we then renamed the columns such that it would be representative of the information in the column. Lastly, since all the data was in character format, we converted all the columns that had numeric data to a numeric form, such that it can be easily used to create graphs and other visual structures to aid us in our exploratory analysis. Our final product of the downloaded data was a dataframe in R, which had columns that were clearly represented by their names, no missing slots or data, and all the data was the right type of class to work with. The top 5 rows of how the dataframe is structured can be seen below. This will be used for different types of analyses on the impact of covid on the airline/travel industry.</p>
<pre><code>##   year    month Tot_Flights Alaska Allegiant American  Delta Frontier Hawaiian JetBlue Southwest Spirit United
## 1 2019  January      619099  34663      6713   162931 134243     9496     7514   23463    107363  15023 117690
## 2 2019 February      564614  30069      7180   150607 121264     8643     6668   22053     94922  13447 109761
## 3 2019    March      675659  35864     10218   173395 151495     9663     7581   25502    114119  17034 130788
## 4 2019    April      652533  35270      9219   165821 146206     9637     7611   24966    110752  16316 126735
## 5 2019      May      680165  37218      9008   177012 151695    11254     7958   24886    113709  17814 129611
## 6 2019     June      679802  37953     11037   173440 153427    11337     7896   24204    112879  17553 130076</code></pre>
</div>
<div id="restaurant-data-1" class="section level2">
<h2><span class="header-section-number">3.5</span> Restaurant data</h2>
<p>Two datasets come in a csv format, which can be read in using R commands. Each row contains information of a country or a state and each columns represent different dates. To clean this data we want to change the date columns to one column.</p>
<p>The original YoY_Seated_Diner_Data-2.csv file contains information about 8 country of 60 state and 60 cities, and the reopen dataset contains 8 countries and 9 states, including 8 US states. Here we only extract US state and nationwide information from the dataset. We will be using these two datasets in order to see trends within the restaurant industry, and how the pandemic affected the closing and reopening of restaurants in each state.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-sources.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="missing-values.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/run-zhang/CovidImpact/edit/main/03-cleaning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/run-zhang/CovidImpact/blob/main/03-cleaning.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
