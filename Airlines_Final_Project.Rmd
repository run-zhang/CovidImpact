---
title: "Airlines_FinalProject"
author: "Neha Pusarla"
date: "12/2/2020"
output: pdf_document
---

## R Markdown

Libraries 
```{r}
library("readxl")
library(ggplot2)
library(tidyverse)
```

Data Transformation 
```{r}
data <- read_excel("/Users/nehapusarla/Documents/EDAV5702/scheduled-canceled-operated-flights-jan2019-jul2020.xlsx")

year <- c(2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019,
          2019, 2019, 2020, 2020, 2020, 2020, 2020, 2020, 2020)
my_data <- data.frame(year)

for (val in 2:length(data)){
  array <- data[val][[1]]
  array <- array[5:23]
  my_data <- cbind(my_data, array)
}

#rename the columns 
names <- c("year", "month", "Tot_Flights", "Alaska",
           "Allegiant", "American", "Delta", "Frontier", "Hawaiian", 
           "JetBlue", "Southwest", "Spirit", "United")
names(my_data) <- names 

#convert to numeric 
my_data$Tot_Flights <- as.numeric(my_data$Tot_Flights)
my_data$Alaska <- as.numeric(my_data$Alaska)
my_data$Allegiant <- as.numeric(my_data$Allegiant)
my_data$American <- as.numeric(my_data$American)
my_data$Delta <- as.numeric(my_data$Delta)
my_data$Frontier <- as.numeric(my_data$Frontier)
my_data$Hawaiian <- as.numeric(my_data$Hawaiian)
my_data$JetBlue <- as.numeric(my_data$JetBlue)
my_data$Southwest <- as.numeric(my_data$Southwest)
my_data$Spirit <- as.numeric(my_data$Spirit)
my_data$United <- as.numeric(my_data$United)
```

Exploratory Analysis 

```{r}
#Main Question: How did Covid impact travel and transportation?

#difference between 2019 vs. 2020 in total flights 
tot_flights_2019 <- sum(my_data['Tot_Flights'][[1]][1:12])
tot_flights_2020 <- sum(my_data['Tot_Flights'][[1]][13:19])
tot_flight_data <- data.frame("year" = c("2019", "2020"), 
                              "flights" = c(tot_flights_2019, tot_flights_2020))
ggplot(tot_flight_data, aes(x = year, y = flights)) +
  geom_bar(stat = "identity", fill='dodgerblue1') +
  ggtitle("Bar Graph of Total Flights in 2019 vs. 2020") 
```

As seen from an overall perspective, there are a lot fewer flights taken in 2020 than in 2019, most likely due to the pandemic. Although, the 2019 data includes all months, while the 2020 data includes only the first 7 months, therefore, we will further our analysis using only the first 7 months of the 2019 data as well.

```{r}
tot_flights_2019 <- sum(my_data['Tot_Flights'][[1]][1:7])
tot_flights_2020 <- sum(my_data['Tot_Flights'][[1]][13:19])
tot_flight_data <- data.frame("year" = c("2019", "2020"), 
                              "flights" = c(tot_flights_2019, tot_flights_2020))
ggplot(tot_flight_data, aes(x = year, y = flights)) +
  geom_bar(stat = "identity", fill='dodgerblue1') +
  ggtitle("Bar Graph of Total Flights in First 7 Months 2019 vs. 2020") 
```

Using only the first 7 months of the 2019 data to compare its results more accuractely with the first 7 months of the 2020 data, there is still a clear distinctment between the number of flights taken in 2019 vs. 2020. But, since we are using all of our 2020 data, we cannot make any analyses on the effect of the pandemic on travel as travel restrictions began in March. Therefore, we are going to plot the difference in flights before the pandemic began and after the coronavirus pandemic began.

```{r}
tot_flights_precovid <- sum(my_data['Tot_Flights'][[1]][13:15])
tot_flights_postcovid <- sum(my_data['Tot_Flights'][[1]][16:19])
tot_flight_data_2020 <- data.frame("time" = c("Pre-Covid", "Post-Covid"), 
                              "flights" = c(tot_flights_precovid, tot_flights_postcovid))
ggplot(tot_flight_data_2020, aes(fct_inorder(time), flights)) +
  geom_bar(stat = "identity", fill='dodgerblue1') +
  ggtitle("Bar Graph of Total Flights PreCovid vs. PostCovid")
```

Using this data, we can clearly see a big drop in flights once the
widespread pandemic started. The number of flights dropped by
almost half. Travel bans started all over the world during this
time, therefore, this data makes sense as more restrictions were
placed, and people from the U.S. weren't able to travel outside the country to these different places anymore. Next, we will take a look at the month by month number of flights, to see if we can extract any additional information about how travel was affected due to the pandemic.

```{r}
data_2020 <- my_data[my_data$year==2020, ]
ggplot(data_2020, aes(fct_inorder(month), Tot_Flights)) +
  geom_bar(stat = "identity", fill='dodgerblue1') +
  ggtitle("Bar Graph of Total Flights in 2020") 
```

The bar graph of the total flights of each month in 2020 shows a
decreasing trend of flights as the year progresses. There is a huge drop in the number of flights between March and April. This is most likely due to the stay at home order starting late March. Although the pandemic started in the US in March, the large amount of flights that month is most likely due to the many people flying back home to be with their families during this time. Around June, the number of flights slowly start to increase, but not to the level that it was at the beginning of the year. People may have been starting to get more lax about the virus and visitations, but travel is still greatly affected as the flights have cut down. Let us see how this affected each airline industry.

```{r}
#See how much percent each airline was affected 
percent_changes <- c() 
for (val in 4:length(data_2020)){
  array <- data_2020[val][[1]]
  percent_change <- 
    ((sum(array[1:3]) - sum(array[4:7])) / 
       sum(array[1:3])) * 100 
  percent_changes <- append(percent_changes, percent_change)
}

airlines <- c("Alaska","Allegiant", "American", "Delta", "Frontier", 
              "Hawaiian", "JetBlue", "Southwest", "Spirit", "United")

ggplot(data.frame(airlines, percent_changes), 
       aes(reorder(airlines, -percent_changes), percent_changes)) +
  geom_bar(stat = "identity", fill='dodgerblue1') +
  ggtitle("Bar Graph of Percent Decrease for each Airline") + 
  xlab("Airline")
```

This data shows by how much percent the number of flights in
each airline decreased from the first couple months, pre-covid,
to the rest of the year, after the oncoming of the pandemic in
the United States. As shown by the graph, every single airline
was affected by the pandemic as they all have a positive percent
change, meaning that there was a decline in the number of flights
for each airline. The airlines that were affected the most were
JetBlue, Hawaiian, and United. These airlines had at least a 60%
decline in flights when the pandemic started.

Final Findings on Airline Data: 

The most revealing findings from this exploratory data analysis 
showed a couple of things. Firstly, there was a major decrease
in flights from the year 2019 to the year 2020. Secondly, the number of flights mainly dropped in April of 2020, correlating with the time that the lockdown started and travel restrictions were placed everywhere. Looking at each airline, there was a decrease of the total number of flights taken for each airline, showing that almost every airline industry was affected by the pandemic. Some airlines had a decrease in flights by more than 60%, showing the intensity of the effect on the airline industry. More than half of their revenue was gone. Overall, in terms of the effect on travel during the coronavirus pandemic, there are clear patterns that show that travel was greatly affected. Airplanes were not a first choice method of transporation anymore, as people were not even travelling in the first place. This major decline in airline transportation and travel in and out of the United States, shows how greatly the pandemic played a role in the decline of the airline industry. 
